{% extends 'base.jinja2' %}
{% from 'components/generic/modalities.jinja2' import modalities with context %}

{% macro modalicon(icons) %}
    {% for icon in icons %}
        <i class="fa {{ icon }}"></i>
    {% endfor %}
{% endmacro %}

{% macro modalimg(imgs) %}
    {% for img, class in imgs.items() %}
        <img class="{{ class }}" src="{{ img }}"></i>
    {% endfor %}
{% endmacro %}


{% block content %}
    {% if voted == False %}
        <div class="Modalities">
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        {{modalities("Bem Vinda(o)", modalicon(["fa-times", "fa-arrow-right", "fa-check"]), ["Você iniciou sua participação! Comece votando em comentários: você pode concordar, discordar ou passar se quiser votar depois"])}}
                        <div class="append-buttons">
                            <a href="#" class="next-slide-1">PRÓXIMO</a>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        {{modalities("Participação", modalimg({'/static/img/icons/artboard.svg' : 'imgpart'}), ["A partir de seus votos, você será posicionado em um grupo de opnião, e poderá ganhar poderes que ajudarão a diversificar os diálogos e furar bolhas de opinião!"])}}
                        <div class="append-buttons">
                            <a href="#" class="next-slide-2">PRÓXIMO</a>
                        </div>
                     </div>
                    <div class="swiper-slide">
                        {{modalities("Poderes", modalimg({'/static/img/icons/iconponte.svg' : 'img', '/static/img/icons/iconativista.svg' : 'img'}), ["Com os poderes, Ativista de Minoria, Ponte de Diálogo e Fura-Bolhas, você ganhará mais poder de fala, aumentando o seu limite de comentários e/ou a visibilidade deles!"])}}
                        <form method="post">
                            {{ csrf_input }}
                            <button type="submit" name="modalities" class="Button" value="pass">CONTINUAR PARTICIPANDO</button>
                        </form>
                    </div>
                </div>
                <div class="swiper-pagination"></div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
            <script>

                var nextArrow = document.createElement('i');
                var prevArrow = document.createElement('i');
                
                nextArrow.setAttribute('class', 'fas fa-angle-right')
                prevArrow.setAttribute('class', 'fas fa-angle-left')

                $(".swiper-button-next").css('cssText', 'background-image: none')
                $(".swiper-button-prev").css('cssText', 'background-image: none')

                var nextBtnDiv = $(".swiper-button-next");
                var prevBtnDiv = $(".swiper-button-prev");

                nextBtnDiv.append(nextArrow);
                prevBtnDiv.append(prevArrow);

                var swiper = new Swiper('.swiper-container', {
                    pagination: {
                        el: '.swiper-pagination',
                    },
                    navigation: {
                        nextEl: '.swiper-button-next',
                        prevEl: '.swiper-button-prev',
                    },
                });
                document.querySelector('.next-slide-1').addEventListener('click', function (e) {
                e.preventDefault();
                swiper.slideTo(1, 0);
                });
                document.querySelector('.next-slide-2').addEventListener('click', function (e) {
                e.preventDefault();
                swiper.slideTo(2, 0);
                });
            </script>
            <script>
                function showModalities-slider() {
                    var x = document.getElementByClassName("Modalities-slider");
                    x.className = "show";
                }
            </script>
            <script>
                showModalities-slider()
            </script>
        </div>
    {#{% else %}


        Modal estático para implementação da gamificação (Ativista de Minoria)
        <div class="Modalities">
            <div class="style-slide-center">
                <div class="style-slide">
                    <form method="get" action={{conversation.get_absolute_url()}}>
                        <button type="submit" class="Button-closer">
                            <i class="fa fa-times"></i>
                        </button>
                    </form>
                    {{modalities("Ativista de Minoria", modalimg({'/static/img/icons/iconativista.svg' : 'imgponte'}), ["O seu grupo parece concordar com você! Mas você votou contrário à maioria nesse comentário.", "Todas as regiões devem ser priorizados nas relações do Brazil. EUA e países do eixo Sul-Sul!", "Para exercer o seu poder de ativista escolha fazer um comentário promovido extra ou promover um comentário seu já criado na conversa"])}}            
                    <form method="post">
                        <button type="submit" class="Button">QUERO IR</button>
                    </form>
                </div>
            </div>
        </div>
        <script>
            function showModalities-slider() {
                var x = document.getElementByClassName("modalities");
                x.className = "show";
            }
        </script>
        <script>
            showModalities-slider()
        </script>



        Modal estático para implementação da gamificação (Ponte de diálogo)
        <div class="Modalities">
            <div class="style-slide-center">
                <div class="style-slide">
                    <form method="get" action={{conversation.get_absolute_url()}}>
                        <button type="submit" class="Button-closer">
                            <i class="fa fa-times"></i>
                        </button>
                    </form>
                    {{modalities("Ponte de diálogo", modalimg({'/static/img/icons/iconponte.svg' : 'imgponte'}), ["Você recebeu o poder Ponte de diálogo, porque, de acordo com as suas opiniões, você está próximo da borda do seu grupo de opinião", "Para exercer o seu poder de ponte, escolha fazer um comentário promovido extra ou promover um comentário seu já criado na conversa"])}}            
                    <form method="post">
                        <button type="submit" class="Button">QUERO IR</button>
                    </form>
                </div>
            </div>
        </div>
        <script>
            function showModalities-slider() {
                var x = document.getElementByClassName("modalities");
                x.className = "show";
            }
        </script>
        <script>
            showModalities-slider()
        </script>#}
    {% endif %}




    <div class="ConversationDetail">
        {# Ballon with title #}
        {{ conversation|role('balloon') }}

        {# Current comment #}
        <div class="ConversationDetail-header"><h1>{{ _('Comments') }}</h1></div>
        {% if comment %}
            {{ comment|role('card') }}
        {% else %}
            <div class="Comment">
                <h1>{{ _('Congratulations!') }}</h1>
                <p>{{ _("There are no comments left to vote :)") }}</p>
                 <p>
                    {# FIXME Add a less hardcoded pluralization  #}
                    {{ _("You have {} comment{} under moderation.").format(comments_under_moderation, "" if comments_under_moderation == 1 else "s")}}
                    {% if comments_under_moderation > 0 %}
                        {{ link(_('Click here'), href='/profile/') }}
                        {{ _("to see {}.").format("it" if comments_under_moderation == 1 else "them") }}
                    {% endif %}
                </p>
            </div>
        {% endif %}



        {# Post a new comment #}
        {{ conversation|role('comment-form', comment_content=comment_form) }}
    </div>
{% endblock %}
