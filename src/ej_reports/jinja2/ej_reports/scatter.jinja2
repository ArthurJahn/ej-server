{% extends 'base.jinja2' %}
{% block content %}
    <div class="Container">
        {% if plot_data is defined %}
            <div id="container" style="width 100%; min-height: 400px"></div>
        {% else %}
            <div class="CenteredContainer">
                <h1>{% trans %}Error!{% endtrans %}</h1>
                <p>{% trans %}Not enough data to show scatter plot!{% endtrans %}</p>
            </div>
        {% endif %}
        <div>
            <a href="..">Go back</a>
        </div>
    </div>
{% endblock %}


{% block javascript_body %}
    {{ super() }}
    {% if plot_data is defined %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/4.1.0/echarts.min.js"></script>
{#        <script src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>#}
{#        <script src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>#}
{#        <script src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>#}
{#        <script src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>#}
{#        <script src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>#}
{#        <script src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>#}
{#        <script src="https://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>#}
{#        <script src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>#}
{#        <script src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>#}
        <script>
            var dom = document.getElementById("container");
            var myChart = echarts.init(dom);
            var plotData = {{ plot_data }};
            console.log(plotData);
            var fullSeries = [];
            var legenda = [];
            for (let gender in plotData) {
                legenda.push(plotData[gender][0][2].toString());
                console.log(plotData[gender][0][2]);
                color = Math.random() * 255;
                fullSeries.push({
                    name: plotData[gender][0][2],
                    data: plotData[gender],
                    type: 'scatter',
                    symbolSize: function (data) {
                        return 10;
                    },
                    label: {
                        emphasis: {
                            show: true,
                            formatter: function (param) {
                                return plotData[gender][0][2];
                            },
                            position: 'top'
                        }
                    },
                     itemStyle: {
                            normal: {
                                shadowBlur: 10,
                                shadowColor: 'rgba(120, 36, 50, 0.5)',
                                shadowOffsetY: 5,
                                color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                    offset: 0,
                                    color: `rgb(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255})`
                                }])
                            }
                        }
                })
            }
            console.log(fullSeries);
            console.log(legenda);
            var option = {
                xAxis: {},
                yAxis: {},
                title: {
                    text: 'Scatterplot'
                },
                legend: {
                    right: 10,
                    data: legenda
                },
                series: fullSeries
            };
            if (option && typeof option === "object") {
                myChart.setOption(option, true);
            }
            $(window).on('resize', function () {
                if (myChart !== null && myChart !== undefined) {
                    myChart.resize();
                }
            });
        </script>
    {% endif %}
{% endblock %}
